-- NexHub | Steal a Brainrot
if getgenv().NexHubLoaded then return end
getgenv().NexHubLoaded = true

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NexHub"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game.CoreGui

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 320, 0, 400)
MainFrame.Position = UDim2.new(0.3, 0, 0.2, 0)
MainFrame.BackgroundColor3 = Color3.fromRGB(50, 0, 80)
MainFrame.BorderSizePixel = 2
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner", MainFrame)
UICorner.CornerRadius = UDim.new(0, 10)

local Title = Instance.new("TextLabel")
Title.Text = "NexHub | Steal a Brainrot"
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundColor3 = Color3.fromRGB(80, 0, 120)
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 20
Title.Parent = MainFrame

local helperFrame = Instance.new("Frame")
helperFrame.Size = UDim2.new(0, 320, 0, 200)
helperFrame.Position = UDim2.new(0.3, 0, 0.6, 0)
helperFrame.BackgroundColor3 = Color3.fromRGB(40, 0, 60)
helperFrame.Visible = false
helperFrame.Parent = ScreenGui
Instance.new("UICorner", helperFrame).CornerRadius = UDim.new(0, 10)

local helperTitle = Instance.new("TextLabel")
helperTitle.Text = "NexHub | Steal Helper"
helperTitle.Size = UDim2.new(1, 0, 0, 30)
helperTitle.BackgroundColor3 = Color3.fromRGB(80, 0, 120)
helperTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
helperTitle.Font = Enum.Font.SourceSansBold
helperTitle.TextSize = 18
helperTitle.Parent = helperFrame

-- функции
local behaviours = {}
local CFG = {AirWalk=false, Float=false, FloorSteal=false, ESP=false, XRay=false}

-- AirWalk
local airPlatform, airConn
behaviours.AirWalk=function(state)
    if state then
        if not airPlatform then
            airPlatform = Instance.new("Part", Workspace)
            airPlatform.Size = Vector3.new(6,1,6)
            airPlatform.Anchored = true
            airPlatform.CanCollide = true
            airPlatform.Color = Color3.fromRGB(150,0,255)
        end
        airConn = RunService.RenderStepped:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local hrp = LocalPlayer.Character.HumanoidRootPart
                airPlatform.Position = hrp.Position - Vector3.new(0,3,0)
            end
        end)
    else
        if airConn then airConn:Disconnect() end
        if airPlatform then airPlatform:Destroy() airPlatform=nil end
    end
end

-- Float
local floatConn
behaviours.Float=function(state)
    if state then
        floatConn=RunService.RenderStepped:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local hrp=LocalPlayer.Character.HumanoidRootPart
                hrp.Velocity=Vector3.new(hrp.MoveDirection.X*40,-2,hrp.MoveDirection.Z*40)
            end
        end)
    else
        if floatConn then floatConn:Disconnect() end
    end
end

-- FloorSteal
local floorPlatform,floorConn
behaviours.FloorSteal=function(state)
    if state then
        if not floorPlatform then
            floorPlatform=Instance.new("Part",Workspace)
            floorPlatform.Size=Vector3.new(6,1,6)
            floorPlatform.Anchored=true
            floorPlatform.CanCollide=true
            floorPlatform.Color=Color3.fromRGB(200,0,200)
        end
        floorConn=RunService.RenderStepped:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local hrp=LocalPlayer.Character.HumanoidRootPart
                floorPlatform.Position=hrp.Position-Vector3.new(0,3,0)+Vector3.new(0,0.6,0)
                -- стены и полы рядом полностью прозрачные
                for _,obj in ipairs(Workspace:GetDescendants()) do
                    if obj:IsA("BasePart") and (obj.Position-hrp.Position).Magnitude<20 and not obj:IsDescendantOf(LocalPlayer.Character) then
                        pcall(function() obj.LocalTransparencyModifier=1 end)
                    end
                end
            end
        end)
    else
        if floorConn then floorConn:Disconnect() end
        if floorPlatform then floorPlatform:Destroy() floorPlatform=nil end
        for _,obj in ipairs(Workspace:GetDescendants()) do
            if obj:IsA("BasePart") and not obj:IsDescendantOf(LocalPlayer.Character) then
                pcall(function() obj.LocalTransparencyModifier=0 end)
            end
        end
    end
end

-- ESP Players
local espConn,espFolder= nil, Instance.new("Folder",ScreenGui)
espFolder.Name="ESP"
behaviours.ESP=function(state)
    if state then
        espConn=RunService.RenderStepped:Connect(function()
            for _,plr in pairs(Players:GetPlayers()) do
                if plr~=LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                    local hrp=plr.Character.HumanoidRootPart
                    local adorn=espFolder:FindFirstChild(plr.Name)
                    if not adorn then
                        adorn=Instance.new("BoxHandleAdornment")
                        adorn.Adornee=hrp
                        adorn.Size=Vector3.new(6,6,6)
                        adorn.Color3=Color3.fromRGB(0,255,100)
                        adorn.Transparency=0.3
                        adorn.ZIndex=0
                        adorn.AlwaysOnTop=true
                        adorn.Parent=espFolder
                        adorn.Name=plr.Name
                    end
                else
                    local adorn=espFolder:FindFirstChild(plr.Name)
                    if adorn then adorn:Destroy() end
                end
            end
        end)
    else
        if espConn then espConn:Disconnect() end
        espFolder:ClearAllChildren()
    end
end

-- XRay (только стены/полы)
behaviours.XRay=function(state)
    local allowedMaterials = {
        [Enum.Material.Concrete]=true,
        [Enum.Material.Wood]=true,
        [Enum.Material.WoodPlanks]=true,
        [Enum.Material.Slate]=true,
        [Enum.Material.Cobblestone]=true,
        [Enum.Material.Grass]=true,
        [Enum.Material.Plastic]=true
    }
    for _,obj in ipairs(Workspace:GetDescendants()) do
        if obj:IsA("BasePart") and not obj:IsDescendantOf(LocalPlayer.Character) and allowedMaterials[obj.Material] then
            pcall(function() obj.LocalTransparencyModifier= state and 0.7 or 0 end)
        end
    end
end

-- UI buttons
local function createButton(text,callback,parent)
    local btn=Instance.new("TextButton")
    btn.Text=text
    btn.Size=UDim2.new(1,-20,0,35)
    btn.Position=UDim2.new(0,10,0,0)
    btn.BackgroundColor3=Color3.fromRGB(100,0,150)
    btn.TextColor3=Color3.fromRGB(255,255,255)
    btn.Font=Enum.Font.SourceSansBold
    btn.TextSize=18
    btn.Parent=parent
    Instance.new("UICorner",btn).CornerRadius=UDim.new(0,8)
    btn.MouseButton1Click:Connect(callback)
    return btn
end

local layout=Instance.new("UIListLayout",MainFrame)
layout.Padding=UDim.new(0,5)
layout.FillDirection=Enum.FillDirection.Vertical
layout.SortOrder=Enum.SortOrder.LayoutOrder
layout.HorizontalAlignment=Enum.HorizontalAlignment.Center
layout.VerticalAlignment=Enum.VerticalAlignment.Top

-- main menu buttons
createButton("AirWalk",function() CFG.AirWalk=not CFG.AirWalk behaviours.AirWalk(CFG.AirWalk) end,MainFrame)
createButton("Float",function() CFG.Float=not CFG.Float behaviours.Float(CFG.Float) end,MainFrame)
createButton("Floor Steal",function() CFG.FloorSteal=not CFG.FloorSteal behaviours.FloorSteal(CFG.FloorSteal) end,MainFrame)
createButton("ESP Players",function() CFG.ESP=not CFG.ESP behaviours.ESP(CFG.ESP) end,MainFrame)
createButton("X-Ray",function() CFG.XRay=not CFG.XRay behaviours.XRay(CFG.XRay) end,MainFrame)

-- helper buttons
local helperLayout=Instance.new("UIListLayout",helperFrame)
helperLayout.Padding=UDim.new(0,5)
helperLayout.FillDirection=Enum.FillDirection.Vertical
helperLayout.SortOrder=Enum.SortOrder.LayoutOrder
helperLayout.HorizontalAlignment=Enum.HorizontalAlignment.Center
helperLayout.VerticalAlignment=Enum.VerticalAlignment.Top

createButton("AirWalk",function() CFG.AirWalk=not CFG.AirWalk behaviours.AirWalk(CFG.AirWalk) end,helperFrame)
createButton("Float",function() CFG.Float=not CFG.Float behaviours.Float(CFG.Float) end,helperFrame)
createButton("Floor Steal",function() CFG.FloorSteal=not CFG.FloorSteal behaviours.FloorSteal(CFG.FloorSteal) end,helperFrame)

-- Hotkeys
UserInputService.InputBegan:Connect(function(input,gp)
    if gp then return end
    if input.KeyCode==Enum.KeyCode.Z then
        CFG.Float=not CFG.Float
        behaviours.Float(CFG.Float)
    elseif input.KeyCode==Enum.KeyCode.K then
        helperFrame.Visible=not helperFrame.Visible
    end
end)
